<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:api-gateway="http://www.mulesoft.org/schema/mule/api-gateway"
	xmlns:cloudhub="http://www.mulesoft.org/schema/mule/cloudhub"
	xmlns:secure-properties="http://www.mulesoft.org/schema/mule/secure-properties"
	xmlns:db="http://www.mulesoft.org/schema/mule/db" xmlns:http="http://www.mulesoft.org/schema/mule/http"
	xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="
http://www.mulesoft.org/schema/mule/api-gateway http://www.mulesoft.org/schema/mule/api-gateway/current/mule-api-gateway.xsd 
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd 
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/secure-properties http://www.mulesoft.org/schema/mule/secure-properties/current/mule-secure-properties.xsd
http://www.mulesoft.org/schema/mule/cloudhub http://www.mulesoft.org/schema/mule/cloudhub/current/mule-cloudhub.xsd">
	
	<http:listener-config name="s-calm2-api-httpListenerConfig">
        <http:listener-connection host="${http.host}" port="${http.private.port}" />
    </http:listener-config>	
    <db:config name="Database_Config" doc:name="Database Config" doc:id="14513c06-7892-4e6a-857e-4199a5fca6fc" >
		<db:mssql-connection host="${db.audit.config.host}" user="${secure::db.audit.config.user}" password="${secure::db.audit.config.password}" databaseName="${db.audit.config.database}" port="${db.audit.config.port}">
			<db:pooling-profile maxPoolSize="${db.pool.size.max}" minPoolSize="${db.pool.size.min}" />
		</db:mssql-connection>
	</db:config>
	<import doc:name="Import" doc:id="41133f26-6fea-4bb8-8634-35a5d49b6143" file="common-auditing-framework.xml" />
	<import doc:name="Import" doc:id="2bd29da3-084d-4cf1-896d-cc8309a98de2" file="common-logging-framework.xml" />
	<configuration-properties doc:name="Configuration properties" doc:id="910103d6-8782-409b-8ed4-7512e95ad436" file="properties/${mule.env}-properties.yaml" />
	<configuration-properties doc:name="Configuration properties" doc:id="f0584373-eb2a-49f6-9729-3f1ff2150b43" file="properties/common-properties.yaml" />
	<configuration-properties doc:name="Configuration properties" doc:id="668b4221-be46-42b8-94e6-4afb98024344" file="properties/error-properties.yaml" />
	<import doc:name="Import" doc:id="67b58860-a77a-4d24-998c-75ed2e333370" file="common-error-handling.xml" />
	<configuration doc:name="Configuration" doc:id="ccd0dfeb-950a-4ddd-b570-30795de8909d" defaultErrorHandler-ref="GlobalExceptionStrategy" />
	<secure-properties:config name="Secure_Properties_Config" doc:name="Secure Properties Config" doc:id="c0bd532a-b394-48b7-9373-888cc10ee8d3" file="properties/${mule.env}-properties.yaml" key="${encryption.key}" />
	<global-property doc:name="Global Property" doc:id="9b14518b-433a-4b24-b532-bf452127c4d5" name="mule.env" value="dev" />
	 <http:request-config name="S_CALM2_Http_Request_configuration" doc:name="HTTP_S_CALM2_Request_configuration" doc:id="2c921702-7acd-41e5-a4c3-c24d5f2f24ef" basePath="${calm2.basePath}" responseTimeout="${response.timeout}">
		<http:request-connection host="${calm2.host}" port="${calm2.port}" />

	</http:request-config>
	<cloudhub:config name="CloudHub_Config" doc:name="CloudHub Config" doc:id="638afb44-151d-482a-960d-f01d5ae023df" >
		<cloudhub:connection username="${secure::cloudhub.username}" password="${secure::cloudhub.password}" environment="${environment.id}" />
	</cloudhub:config>
	<api-gateway:autodiscovery apiId="${api.discovery.id}" doc:name="API Autodiscovery" doc:id="15f66d0f-86d0-4c57-a87d-e6405ae84289" flowRef="s-calm2-api-main" />
</mule>
